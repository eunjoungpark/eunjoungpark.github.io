{"version":3,"sources":["container/myPage/Orders.js"],"names":["OrderWrap","styled","div","EmptyBox","mapDispatchToProps","initOrderList","emptyOrderList","connect","auth","order","loadings","orderList","lists","page","endAt","finish","loadingOrder","ORDER_LIST","history","useState","isScroll","setIsScroll","initOrder","useCallback","limit","token","idToken","userId","localId","onScroll","innerHeight","window","scrollHeight","document","body","documentElement","scrollTop","useEffect","push","addEventListener","emptyLoading","removeEventListener","width","scope","length","colSpan","map","o","index","date","Date","key","className","contents","commas","total","store","name","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds"],"mappings":"4+BAaA,IAAMA,EAAYC,IAAOC,IAAV,KA+BTC,EAAWF,IAAOC,IAAV,KAgJRE,EAAqB,CAAEC,kBAAeC,oBAE7BC,sBAVS,SAAC,GAAD,IAAGC,EAAH,EAAGA,KAAMC,EAAT,EAASA,MAAOC,EAAhB,EAAgBA,SAAhB,MAAgC,CACtDF,OACAG,UAAWF,EAAMG,MACjBC,KAAMJ,EAAMK,MACZC,OAAQN,EAAMM,OACdC,aAAcN,EAASO,OAOvBb,EAFaG,CAzIA,SAAC,GAST,IARLC,EAQI,EARJA,KACAG,EAOI,EAPJA,UACAE,EAMI,EANJA,KAEAR,GAII,EALJU,OAKI,EAJJV,eACAC,EAGI,EAHJA,eACAU,EAEI,EAFJA,aACAE,EACI,EADJA,QACI,EAC4BC,oBAAS,GADrC,mBACGC,EADH,KACaC,EADb,KAGEC,EAAYC,sBAChB,SAAAC,GACEnB,EAAc,CACZoB,MAAOjB,EAAKkB,QACZC,OAAQnB,EAAKoB,QACbf,OACAW,WAGJ,CAAChB,EAAKkB,QAASlB,EAAKoB,QAASvB,EAAeQ,IAIxCgB,EAAWN,sBAAY,WAAO,IAC1BO,EAAgBC,OAAhBD,YACAE,GAAiBC,SAASC,MAAQD,SAASE,iBAA3CH,aACFI,EACJH,SAASC,KAAKE,WAAaH,SAASE,gBAAgBC,UAEpDf,EADEW,EAAeF,EAAcM,EAAY,KAK5C,IA4BH,OAzBAC,oBAAU,WACJ7B,EAAKoB,QACPN,EAAU,IAEVJ,EAAQoB,KAAK,MAEd,CAAC9B,EAAKoB,QAASV,IAGlBmB,oBAAU,WACJjB,GACFE,EAlDQ,KAoDT,CAACF,IAGJiB,oBAAU,WAER,OADAN,OAAOQ,iBAAiB,SAAUV,GAAU,GACrC,WACLW,YAAavB,KACbX,IACAyB,OAAOU,oBAAoB,SAAUZ,GAAU,KAEhD,CAACvB,EAAgBuB,IAGlB,kBAAC,IAAD,KACE,kBAAC,IAAD,kCACCb,GAAgB,kBAAC,IAAD,MACjB,kBAAChB,EAAD,KACE,+BACE,kCACE,yBAAK0C,MAAM,QACX,yBAAKA,MAAM,QACX,yBAAKA,MAAM,QACX,yBAAKA,MAAM,SAEb,+BACE,4BACE,wBAAIC,MAAM,OAAV,OACA,wBAAIA,MAAM,OAAV,6BACA,wBAAIA,MAAM,OAAV,gBACA,wBAAIA,MAAM,OAAV,kBAGJ,+BACGhC,EAAUiC,QAAU,EACnB,4BACE,wBAAIC,QAAQ,KACV,kBAAC1C,EAAD,mEAIJQ,EAAUmC,IAAI,SAACC,EAAGC,GAChB,IAAMC,EAAO,IAAIC,KAAKH,EAAEE,MACxB,OACE,wBAAIE,IAAKH,GACP,wBAAII,UAAU,OAAOJ,EAAQ,GAC7B,4BACE,uBAAGI,UAAU,QAAQL,EAAEM,UACvB,uBAAGD,UAAU,SACX,yDADF,IAC2BE,YAAOP,EAAEQ,OADpC,WAIF,4BAAKR,EAAES,MAAMC,MACb,wBAAIL,UAAU,QAAd,UACMH,EAAKS,cADX,YAC4BT,EAAKU,WAC7B,EAFJ,YAESV,EAAKW,WAAa,IACzB,6BAHF,UAIMX,EAAKY,WAJX,cAI2BZ,EAAKa,aAJhC,cAIkDb,EAAKc","file":"static/js/11.0792a1f4.chunk.js","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport styled from 'styled-components';\r\nimport { commas } from '../../libs/util';\r\nimport { Contents, PageTitle } from '../../components/common';\r\nimport Loading from '../../components/loading/Loading';\r\nimport { initOrderList, emptyOrderList, ORDER_LIST } from '../../store/order';\r\nimport { emptyLoading } from '../../store/loadings';\r\n\r\n/*\r\n  STYLE\r\n*/\r\nconst OrderWrap = styled.div`\r\n  table {\r\n    width: 100%;\r\n    border: 1px solid #cdcdcd;\r\n    thead {\r\n      th {\r\n        height: 30px;\r\n        background-color: #333;\r\n        color: #fff;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n    tbody {\r\n      & > tr:nth-child(even) {\r\n        background-color: #ededed;\r\n      }\r\n      td {\r\n        height: 60px;\r\n        line-height: 1.3;\r\n        font-size: 14px;\r\n        text-align: center;\r\n        .info {\r\n          white-space: nowrap;\r\n          overflow: hidden;\r\n          text-overflow: ellipsis;\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst EmptyBox = styled.div`\r\n  padding: 40px;\r\n  color: #666;\r\n  text-align: center;\r\n  font-size: 16px;\r\n`;\r\n\r\n//가져올 주문정보 수\r\nconst LIMIT = 11;\r\nconst Orders = ({\r\n  auth,\r\n  orderList,\r\n  page,\r\n  finish,\r\n  initOrderList,\r\n  emptyOrderList,\r\n  loadingOrder,\r\n  history,\r\n}) => {\r\n  const [isScroll, setIsScroll] = useState(false); //스코롤상태 저장\r\n  //초기 주문정보 요청\r\n  const initOrder = useCallback(\r\n    limit => {\r\n      initOrderList({\r\n        token: auth.idToken,\r\n        userId: auth.localId,\r\n        page,\r\n        limit,\r\n      });\r\n    },\r\n    [auth.idToken, auth.localId, initOrderList, page],\r\n  );\r\n\r\n  //스크롤 이벤트핸들러 처리함수\r\n  const onScroll = useCallback(() => {\r\n    const { innerHeight } = window;\r\n    const { scrollHeight } = document.body || document.documentElement;\r\n    const scrollTop =\r\n      document.body.scrollTop || document.documentElement.scrollTop;\r\n    if (scrollHeight - innerHeight - scrollTop < 10) {\r\n      setIsScroll(true);\r\n    } else {\r\n      setIsScroll(false);\r\n    }\r\n  }, []);\r\n\r\n  //초기 주문내역 10개 가져옴\r\n  useEffect(() => {\r\n    if (auth.localId) {\r\n      initOrder(10);\r\n    } else {\r\n      history.push('/');\r\n    }\r\n  }, [auth.localId, history]);\r\n\r\n  //주문내역 10개 가져옴\r\n  useEffect(() => {\r\n    if (isScroll) {\r\n      initOrder(LIMIT);\r\n    }\r\n  }, [isScroll]);\r\n\r\n  //스크롤이벤트 처리\r\n  useEffect(() => {\r\n    window.addEventListener('scroll', onScroll, false);\r\n    return () => {\r\n      emptyLoading(ORDER_LIST);\r\n      emptyOrderList();\r\n      window.removeEventListener('scroll', onScroll, false);\r\n    };\r\n  }, [emptyOrderList, onScroll]);\r\n\r\n  return (\r\n    <Contents>\r\n      <PageTitle>주문 내역</PageTitle>\r\n      {loadingOrder && <Loading />}\r\n      <OrderWrap>\r\n        <table>\r\n          <colgroup>\r\n            <col width=\"10%\" />\r\n            <col width=\"35%\" />\r\n            <col width=\"30%\" />\r\n            <col width=\"25%\" />\r\n          </colgroup>\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">NO.</th>\r\n              <th scope=\"col\">주문 내용</th>\r\n              <th scope=\"col\">지점</th>\r\n              <th scope=\"col\">날짜</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {orderList.length <= 0 ? (\r\n              <tr>\r\n                <td colSpan=\"4\">\r\n                  <EmptyBox>주문내역이 없습니다.</EmptyBox>\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              orderList.map((o, index) => {\r\n                const date = new Date(o.date);\r\n                return (\r\n                  <tr key={index}>\r\n                    <td className=\"num\">{index + 1}</td>\r\n                    <td>\r\n                      <p className=\"info\">{o.contents}</p>\r\n                      <p className=\"total\">\r\n                        <strong>결제액 : </strong> {commas(o.total)}원\r\n                      </p>\r\n                    </td>\r\n                    <td>{o.store.name}</td>\r\n                    <td className=\"date\">\r\n                      {`${date.getFullYear()}.${date.getMonth() +\r\n                        1}.${date.getDate()}`}{' '}\r\n                      <br />\r\n                      {`${date.getHours()} : ${date.getMinutes()} : ${date.getSeconds()}`}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </OrderWrap>\r\n    </Contents>\r\n  );\r\n};\r\n\r\nOrders.propTypes = {\r\n  order: PropTypes.object,\r\n  auth: PropTypes.object.isRequired,\r\n  initOrderList: PropTypes.func.isRequired,\r\n  loadingOrder: PropTypes.bool,\r\n};\r\n\r\nconst mapStateToProps = ({ auth, order, loadings }) => ({\r\n  auth,\r\n  orderList: order.lists,\r\n  page: order.endAt,\r\n  finish: order.finish,\r\n  loadingOrder: loadings[ORDER_LIST],\r\n});\r\n\r\nconst mapDispatchToProps = { initOrderList, emptyOrderList };\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps,\r\n)(Orders);\r\n"],"sourceRoot":""}